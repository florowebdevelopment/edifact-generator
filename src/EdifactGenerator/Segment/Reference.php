<?php

namespace Florowebdevelopment\EdifactGenerator\Segment;

use Florowebdevelopment\EdifactGenerator\Segment;

/**
 * Reference.
 *
 * @see https://service.unece.org/trade/untdid/d17b/trsd/trsdrff.htm
 */
class Reference extends Segment
{
    const SEGMENT_NAME = 'RFF';

    protected $sReferenceCodeQualifier;
    protected $sReferenceIdentifier;
    protected $sDocumentLineIdentifier;
    protected $sVersionIdentifier;
    protected $sRevisionIdentifier;

    /**
     * Set Reference Code Qualifier.
     *
     * @param int $sReferenceCodeQualifier (1153)
     *
     * @return self $this
     */
    public function setReferenceCodeQualifier(string $sReferenceCodeQualifier): self
    {
        $this->sReferenceCodeQualifier = $sReferenceCodeQualifier;

        return $this;
    }

    /**
     * Set Reference Identifier.
     *
     * @param int $sReferenceIdentifier (1154)
     *
     * @return self $this
     */
    public function setReferenceIdentifier(string $sReferenceIdentifier): self
    {
        $this->sReferenceIdentifier = $sReferenceIdentifier;

        return $this;
    }

    /**
     * Set Document Line Identifier.
     *
     * @param int $sDocumentLineIdentifier (1156)
     *
     * @return self $this
     */
    public function setDocumentLineIdentifier(string $sDocumentLineIdentifier): self
    {
        $this->sDocumentLineIdentifier = $sDocumentLineIdentifier;

        return $this;
    }

    /**
     * Set Version Identifier.
     *
     * @param int $sVersionIdentifier (1056)
     *
     * @return self $this
     */
    public function setVersionIdentifier(string $sVersionIdentifier): self
    {
        $this->sVersionIdentifier = $sVersionIdentifier;

        return $this;
    }

    /**
     * Set Revision Identifier.
     *
     * @param int $sRevisionIdentifier (1060)
     *
     * @return self $this
     */
    public function setRevisionIdentifier(string $sRevisionIdentifier): self
    {
        $this->sRevisionIdentifier = $sRevisionIdentifier;

        return $this;
    }

    /**
     * Compose.
     *
     * @return self $this
     */
    public function compose(): self
    {
        $aComposed[] = self::SEGMENT_NAME;

        // Reference Code Qualifier
        $aReference[] = $this->sReferenceCodeQualifier;

        // Reference Identifier

        if ($this->sReferenceIdentifier !== null) {
            $aReference[] = $this->sReferenceIdentifier;
        }

        // Document Line Identifier

        if ($this->sDocumentLineIdentifier !== null) {
            $aReference[] = $this->sDocumentLineIdentifier;
        }

        // Version Identifier

        if ($this->sVersionIdentifier !== null) {
            $aReference[] = $this->sVersionIdentifier;
        }

        // Revision Identifier

        if ($this->sRevisionIdentifier !== null) {
            $aReference[] = $this->sRevisionIdentifier;
        }

        if (count($aReference) > 0) {
            $aComposed[] = $aReference;
        }

        $this->setComposed($aComposed);

        return $this;
    }
}
